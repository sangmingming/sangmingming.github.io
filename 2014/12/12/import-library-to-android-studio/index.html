<!DOCTYPE html><html lang="Chinese"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 导入开源库到基于Android Studio构建的项目中 · 码农明明桑</title><meta name="description" content="导入开源库到基于Android Studio构建的项目中 - Sam"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.isming.me/atom.xml" title="码农明明桑"></head><body><div class="wrap"><header><a href="/" class="logo-link"><!--img(src=url_for(theme.logo) alt="logo")--><h1>码农明明桑</h1></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">HOME</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/links" target="_self" class="nav-list-link">FRIENDS</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">导入开源库到基于Android Studio构建的项目中</h1><div class="post-info">Dec 12, 2014</div><div class="post-content"><p>前两天，谷歌发布了Android Studio 1.0的正式版，也有更多的人开始迁移到Android Studio进行开发。然而，网上很多的开源库,控件等还是以前的基于Eclipse进行开发，很多人不知道怎么导入到自己的基于Android Studio项目中来，微博上也有人私信我，让我来写写，正好今天回来的比较早，就写写吧。主要介绍一下常见的一些导包的场景。</p>
<a id="more"></a>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">--project   <span class="comment">//项目目录</span></div><div class="line">  |</div><div class="line">  build.gradle  <span class="comment">//项目的gradle配置文件</span></div><div class="line">  |</div><div class="line">  settings.gradle　／／gradle设置，会保存所有的<span class="keyword">module</span></div><div class="line">  |</div><div class="line">  app    <span class="comment">//module　目录</span></div><div class="line">  |__build.gradle　<span class="keyword">module</span>的配置</div><div class="line">  |</div><div class="line">  module2  <span class="comment">//module2目录</span></div><div class="line">  |__build.gradle　<span class="keyword">module</span>的配置</div></pre></td></tr></table></figure>
<p>同eclipse中的项目一样，gradle/android studio 构建也可以有module，将moudle放到项目目录下面,然后在settings.gradle中增加该module，最简单的方法是用文件夹名。比如我们上面的结构，build.gradle文件应该如下：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">include <span class="string">':app'</span>, <span class="string">':module2'</span></div></pre></td></tr></table></figure></p>
<p>更多关于gralde的知识可以看我以前的文章:</p>
<p><a href="http://blog.isming.me/2014/11/21/use-gradle-new/">使用gradle构建android项目（续）</a><br><a href="http://blog.isming.me/2014/05/20/android4gradle/">使用Gradle构建Android项目</a></p>
<h3 id="导入Jar文件"><a href="#导入Jar文件" class="headerlink" title="导入Jar文件"></a>导入Jar文件</h3><p>这种可能很常见，可以下载到别人搞好的jar包，这样可以直接在自己的主module下创建libs文件夹(我这里这样，只是为了兼容eclipse方式),然后把jar文件放进去,然后在module的<code>build.gradle</code>文件中的<code>dependecies{}</code>添加如下代码：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile files(<span class="string">'libs/name.jar'</span>)</div></pre></td></tr></table></figure></p>
<p>当libs文件夹下面有多个文件时，可以用一句代码包含这些包:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile fileTree(<span class="string">dir:</span> <span class="string">'libs'</span>, <span class="string">include:</span> [<span class="string">'*.jar'</span>])</div></pre></td></tr></table></figure></p>
<p>当有文件不需要被包含时，可以这样:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile fileTree(<span class="string">dir:</span> <span class="string">'libs'</span>, <span class="string">exclude:</span> [<span class="string">'android-support*.jar'</span>], <span class="string">include:</span> [<span class="string">'*.jar'</span>])</div></pre></td></tr></table></figure></p>
<p>从上面的代码中可以看到我们可以使用通配符, <code>+</code>表示一个字符，<code>*</code>表示０到多个字符。</p>
<h3 id="导入maven中的库"><a href="#导入maven中的库" class="headerlink" title="导入maven中的库"></a>导入maven中的库</h3><p>如果开源库作者有将代码放到Maven库中，我们可以在gradle配置中直接引入,类似如下:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile <span class="string">'com.github.dmytrodanylyk.android-process-button:library:1.0.1'</span></div></pre></td></tr></table></figure></p>
<p>一般我们可以在开源库的github页面上面看有没有这样一个地址，或者到maven库中根据包名搜索有没有,我们前面这个引入的项目分三个部分 <em>group:name:version</em>，我们引入其他的包也有遵守这个规则。</p>
<h3 id="导入gradle构建的开源库"><a href="#导入gradle构建的开源库" class="headerlink" title="导入gradle构建的开源库"></a>导入gradle构建的开源库</h3><p>这种情况的比较少用到，因为这张的开源库，作者一般都有放到maven库中，但是偶尔也会用到这里也提一下。</p>
<p>首先下载文件，将我们需要的这个库的module文件夹拷贝到我们的项目的目录下面，然后在setting.gradle文件中增加文件夹名称, 然后在我们需要依赖这个模块的module中的build.gradle文件中加入如下代码:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile project(<span class="string">':libmodule'</span>)</div></pre></td></tr></table></figure></p>
<p>这样就可以了。</p>
<h3 id="导入基于Eclipse构建的开源库"><a href="#导入基于Eclipse构建的开源库" class="headerlink" title="导入基于Eclipse构建的开源库"></a>导入基于Eclipse构建的开源库</h3><p>基于Eclipse构建的项目，和基于Android Studio构建的项目的很大区别是目录结构不同。<br>我们首先将module文件夹拷贝到我们的项目目录下面，然后在settings.gradle文件中增加这个module，然后在要使用的module中的build.gradle文件中引入依赖，这样看的话，似乎和引入基于gradle构建的没什么不同。但是，基于Eclipse构建的项目中，没有build.gradle文件，所以我们需要自己新建一个放到module下面,下面是一个模版：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">apply <span class="string">plugin:</span> <span class="string">'android-library'</span></div><div class="line"></div><div class="line">repositories &#123;</div><div class="line">    mavenCentral()</div><div class="line">&#125;</div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion <span class="number">19</span></div><div class="line">    buildToolsVersion <span class="string">"20.0.0"</span></div><div class="line"></div><div class="line">    defaultConfig &#123;</div><div class="line">        minSdkVersion <span class="number">9</span></div><div class="line">        targetSdkVersion <span class="number">19</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    sourceSets &#123;</div><div class="line">        main &#123;</div><div class="line">            manifest.srcFile <span class="string">'AndroidManifest.xml'</span></div><div class="line">            java.srcDirs = [<span class="string">'src'</span>]</div><div class="line">            resources.srcDirs = [<span class="string">'src'</span>]</div><div class="line">            aidl.srcDirs = [<span class="string">'src'</span>]</div><div class="line">            res.srcDirs = [<span class="string">'res'</span>]</div><div class="line">            assets.srcDirs = [<span class="string">'assets'</span>]</div><div class="line">            jniLibs.srcDirs = [<span class="string">'libs'</span>]</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    lintOptions &#123;</div><div class="line">        abortOnError <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">dependencies &#123;</div><div class="line">    compile fileTree(<span class="string">dir:</span> <span class="string">'libs'</span>, <span class="string">include:</span> [<span class="string">'*.jar'</span>])</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当然，根据各自的sdk和buildtools版本等等，以及其他，配置会有变化，可以看我之前的文章。</p>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><p>以上就是主要的集中导入场景，自己可以根据自己的实际情况然后改变配置等等。</p>
<p>另外,我们导入的仓库可能不是maven中心仓库，或者可能是我们自己搭建的仓库,我们可以自定义仓库地址的,修改build.gradle文件中的repositories就可以了，例如:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">buildscript &#123;</div><div class="line">    repositories &#123;</div><div class="line">        jcenter()</div><div class="line">        mavenCentral()</div><div class="line">        maven &#123;</div><div class="line">            url <span class="string">"https://oss.sonatype.org/content/repositories/snapshots"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>另外，project层的buildscript在module层也是会生效的，所以不用在每个module都配置。</p>
<blockquote>
<p>原文地址：<a href="http://blog.isming.me/2014/12/12/import-library-to-android-studio/">http://blog.isming.me/2014/12/12/import-library-to-android-studio/</a>，转载请注明出处。</p>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a href="/2015/01/05/2014-review/" class="prev">PREV</a><a href="/2014/11/21/use-gradle-new/" class="next">NEXT</a></div><div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div><script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script><script>var cloudTieConfig = {
    url: document.location.href,
    sourceId: "2014/12/12/import-library-to-android-studio/",
    productKey: "a094f65b0cf3436d922737584f8a4bb2",
    target: "cloud-tie-wrapper"
};
var yunManualLoad = true;
Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);</script><div class="copyright"><p>© 2013 - 2017 <a href="http://blog.isming.me">Sam</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script src="//hm.baidu.com/h.js?c22f102f5fbaa79cf43b93add1805f4f"></script></body></html>