<!DOCTYPE html><html lang="Chinese"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 管理Activity的生命周期 · 码农明明桑</title><meta name="description" content="管理Activity的生命周期 - Sam"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.isming.me/atom.xml" title="码农明明桑"></head><body><div class="wrap"><header><a href="/" class="logo-link"><!--img(src=url_for(theme.logo) alt="logo")--><h1>码农明明桑</h1></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">HOME</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/links" target="_self" class="nav-list-link">FRIENDS</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">管理Activity的生命周期</h1><div class="post-info">Mar 25, 2014</div><div class="post-content"><p>Activity是android的四大组件之一，我们编写程序时，主要通过Activity来显示我们的UI。我们需要了解他的生命周期，以及 每个周期可以做什么。<br>一个Activity存在三种状态：</p>
<h4 id="Resumed："><a href="#Resumed：" class="headerlink" title="Resumed："></a>Resumed：</h4><p>activity显示在屏幕的最前面，并且获取用户焦点。 </p>
<h4 id="Paused："><a href="#Paused：" class="headerlink" title="Paused："></a>Paused：</h4><p>其他activity在当前activity之前，并获得焦点。当前activity还能够部分显示，仍然维护着所有状态，当内存低的时候才会被系统杀死。</p>
<h4 id="Stopped："><a href="#Stopped：" class="headerlink" title="Stopped："></a>Stopped：</h4><p>当前activity完全不可见。但是仍然存在，其他应用需要内存的时候会被杀死（不一定是低内存的时候）。</p>
<a id="more"></a>
<h4 id="具体生命周期见图："><a href="#具体生命周期见图：" class="headerlink" title="具体生命周期见图："></a>具体生命周期见图：</h4><p><img src="http://isming.qiniudn.com/activity_lifecycle.png" alt=""></p>
<ol>
<li>启动Activity<br>执行onCreate（） –&gt; onStart（） –&gt; onResumed()<br>这个过程执行完，我们的activity就显示在屏幕上了。<br>我们可以重写相应的方法，在其中实现我们需要的操作。    </li>
<li>销毁Activity<br>当我们执行<code>finish（）</code>或者被系统强制杀死时，我们的activity会被销毁。<br>我们的activity内部会执行 onPause（）–&gt;onStop()-&gt;onDestory()    </li>
<li>暂停和继续<br>当我们的界面被部分挡住时，会进入暂停状态。<br>此时会执行onPause（）<br>界面重新完全显示后又会回到继续状态（Resumed），会执行onResumed（）<br>在即将pause时，我应应该在onPause中执行一些释放操作，比如停止正在进行的动画，一些用户的状态（确定用户会保存的，比如邮件草稿），释放系统支援（如广播接收者，传感器），以及其他会消耗电池并且在paused时用户不需要用到的。<br>同时这些释放或者保存的，我们在onResumed时候需要恢复。    </li>
<li>停止和重启<br>用户进去其他界面之后，如接听电话，或者打开其他activity，我们的界面会停止，进入stoped状态。此时会执行onPause（）–&gt;onStop()<br>重启时会执行onRestart（）–&gt;onStart()–&gt;onResume()<br>重启时候和我们创建时相比，多一步onRestart（）。<br>​在stop的时候，我们需要执行一些比在onPause中更加消耗CPU的更大的任务，比如写数据库。<br>​同时建议，在onStart（）中恢复，而不是在onRestart（）中恢复。     </li>
<li>重新创建Activity<br>​ ​当我们的进程被destory（不是用户主动调用finish），可以返回。返回的时候会重新创建。执行过程和创建activity一样。<br>​当activity被系统kill之前，会调用onSaveInstanceState（）去保存UI状态，如果我们有信息需要保存，也可以去重写这个方法去做。<br>同时我们可以重写onRestoreInstanceState（）去恢复状态。不重写，系统会恢复系统保存的那一部分UI。或者我们可以在onCreate中恢复，onCreate的参数savedInstanceState就是我们保存的信息，可以判断该参数是否为空，来恢复界面。</li>
</ol>
</div></article></div></main><footer><div class="paginator"><a href="/2014/04/02/android-message-loop-analyze/" class="prev">PREV</a><a href="/2014/03/22/toast-use/" class="next">NEXT</a></div><div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div><script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script><script>var cloudTieConfig = {
    url: document.location.href,
    sourceId: "2014/03/25/manage-activityde-lifecycle/",
    productKey: "a094f65b0cf3436d922737584f8a4bb2",
    target: "cloud-tie-wrapper"
};
var yunManualLoad = true;
Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);</script><div class="copyright"><p>© 2013 - 2017 <a href="http://blog.isming.me">Sam</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script src="//hm.baidu.com/h.js?c22f102f5fbaa79cf43b93add1805f4f"></script></body></html>